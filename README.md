# åœ¨çº¿æ•¬æ‹œæ­Œæ›²åº“æ’­æ”¾å™¨

ä¸€ä¸ªåŸºäº Web çš„éŸ³ä¹æ’­æ”¾å™¨ï¼Œç”¨äºæ’­æ”¾æ•¬æ‹œæ­Œæ›²ï¼Œæ”¯æŒåŸå”±å’Œä¼´å¥ï¼Œæ˜¾ç¤ºæ­Œè°±ï¼Œä»¥åŠæ‰¹é‡ä¸‹è½½åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸµ æ’­æ”¾åŸå”±å’Œä¼´å¥éŸ³è½¨
- ğŸ¼ æ˜¾ç¤ºæ­Œè°±å›¾ç‰‡
- ğŸ“¦ æ‰¹é‡ä¸‹è½½ï¼ˆZIP æ ¼å¼ï¼‰
- ğŸ“± å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯
- ğŸ” æ­Œæ›²æœç´¢åŠŸèƒ½
- ğŸ² éšæœºæ’­æ”¾æ¨¡å¼
- ğŸ“‚ è‡ªåŠ¨ä» R2 å­˜å‚¨æ¡¶åŠ è½½æ­Œæ›²åˆ—è¡¨

## éƒ¨ç½²æŒ‡å—

### å‰ææ¡ä»¶

1. Cloudflare è´¦æˆ·
2. ä¸€ä¸ª R2 å­˜å‚¨æ¡¶ï¼ŒåŒ…å«æŒ‰ä»¥ä¸‹ç»“æ„ç»„ç»‡çš„æ­Œæ›²æ–‡ä»¶ï¼š
   ```
   R2 å­˜å‚¨æ¡¶/
   â”œâ”€â”€ æ­Œæ›²å1/
   â”‚   â”œâ”€â”€ æ­Œæ›²å1.mp3          # åŸå”±
   â”‚   â”œâ”€â”€ æ­Œæ›²å1[ä¼´å¥].mp3    # ä¼´å¥ï¼ˆå¯é€‰ï¼‰
   â”‚   â””â”€â”€ æ­Œæ›²å1.jpg          # æ­Œè°±ï¼ˆå¯é€‰ï¼‰
   â””â”€â”€ æ­Œæ›²å2/
       â”œâ”€â”€ æ­Œæ›²å2.mp3
       â”œâ”€â”€ æ­Œæ›²å2[ä¼´å¥].mp3
       â””â”€â”€ æ­Œæ›²å2.jpg
   ```

### æ­¥éª¤1ï¼šéƒ¨ç½²åˆ° Cloudflare Pages

1. å°†ä»£ç æ¨é€åˆ° Git ä»“åº“ï¼ˆGitHub, GitLab ç­‰ï¼‰
2. ç™»å½• Cloudflare Dashboard
3. è½¬åˆ° **Pages** > **Create a project**
4. è¿æ¥æ‚¨çš„ Git ä»“åº“
5. è®¾ç½®æ„å»ºé…ç½®ï¼š
   - **Build command**: ç•™ç©º
   - **Build output directory**: `/`
6. ç‚¹å‡» **Save and Deploy**

### æ­¥éª¤2ï¼šé…ç½® R2 å­˜å‚¨æ¡¶ç»‘å®š

**é‡è¦ï¼šè¿™ä¸€æ­¥æ˜¯è§£å†³ "æ— æ³•åŠ è½½æ­Œæ›²åˆ—è¡¨" é”™è¯¯çš„å…³é”®**

1. åœ¨ Cloudflare Dashboard ä¸­ï¼Œè½¬åˆ°æ‚¨çš„ Pages é¡¹ç›®
2. ç‚¹å‡» **Settings** æ ‡ç­¾
3. åœ¨å·¦ä¾§èœå•ä¸­é€‰æ‹© **Functions**
4. æ»šåŠ¨åˆ° **R2 bucket bindings** éƒ¨åˆ†
5. ç‚¹å‡» **Add binding**
6. å¡«å†™ï¼š
   - **Variable name**: `SONG_BUCKET`
   - **R2 bucket**: é€‰æ‹©æ‚¨çš„ R2 å­˜å‚¨æ¡¶ï¼ˆä¾‹å¦‚ `worship`ï¼‰
7. ç‚¹å‡» **Save**

### æ­¥éª¤3ï¼šé…ç½® R2 å­˜å‚¨æ¡¶å…¬å…±è®¿é—®

1. è½¬åˆ° **R2 Object Storage**
2. é€‰æ‹©æ‚¨çš„å­˜å‚¨æ¡¶
3. è½¬åˆ° **Settings** æ ‡ç­¾
4. åœ¨ **Public access** éƒ¨åˆ†ï¼š
   - å¯ç”¨ **Allow Access**
   - è®¾ç½®è‡ªå®šä¹‰åŸŸåæˆ–ä½¿ç”¨æä¾›çš„ R2.dev åŸŸå
5. è®°å½•å…¬å…±è®¿é—® URL

### æ­¥éª¤4ï¼šæ›´æ–°å‰ç«¯é…ç½®

åœ¨ `scripts.js` ä¸­æ›´æ–° R2 åŸºç¡€ URLï¼š

```javascript
const R2_BASE_URL = "https://ä½ çš„R2åŸŸå/worship";
```

### æ­¥éª¤5ï¼šé‡æ–°éƒ¨ç½²

1. æäº¤æ›´æ”¹åˆ° Git ä»“åº“
2. Cloudflare Pages å°†è‡ªåŠ¨é‡æ–°éƒ¨ç½²
3. ç­‰å¾…éƒ¨ç½²å®Œæˆ

## æ•…éšœæ’é™¤

### é”™è¯¯ï¼šæ— æ³•åŠ è½½æ­Œæ›²åˆ—è¡¨

**å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼š**

1. **R2 ç»‘å®šæœªé…ç½®**
   - ç¡®ä¿å·²æŒ‰æ­¥éª¤2é…ç½® R2 å­˜å‚¨æ¡¶ç»‘å®š
   - æ£€æŸ¥å˜é‡åæ˜¯å¦ä¸º `SONG_BUCKET`
   - æ£€æŸ¥å­˜å‚¨æ¡¶åç§°æ˜¯å¦æ­£ç¡®

2. **R2 å­˜å‚¨æ¡¶è®¿é—®æƒé™**
   - ç¡®ä¿ R2 å­˜å‚¨æ¡¶å·²å¯ç”¨å…¬å…±è®¿é—®
   - æ£€æŸ¥ R2 åŸŸåé…ç½®æ˜¯å¦æ­£ç¡®

3. **æ–‡ä»¶ç»“æ„é—®é¢˜**
   - ç¡®ä¿æ–‡ä»¶æŒ‰ç…§è¦æ±‚çš„ç›®å½•ç»“æ„ç»„ç»‡
   - æ£€æŸ¥æ–‡ä»¶åå’Œæ‰©å±•åæ˜¯å¦æ­£ç¡®

4. **ç½‘ç»œæˆ–CORSé—®é¢˜**
   - æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„ç½‘ç»œæ ‡ç­¾
   - æŸ¥çœ‹æ˜¯å¦æœ‰CORSé”™è¯¯

### è°ƒè¯•æ­¥éª¤

1. **æ£€æŸ¥ API å“åº”**
   ```
   è®¿é—®: https://ä½ çš„åŸŸå.pages.dev/api/songs
   ```
   åº”è¯¥è¿”å› JSON æ ¼å¼çš„æ­Œæ›²åˆ—è¡¨

2. **æŸ¥çœ‹ Pages Functions æ—¥å¿—**
   - è½¬åˆ° Cloudflare Dashboard > Pages > ä½ çš„é¡¹ç›®
   - ç‚¹å‡» **Functions** æ ‡ç­¾
   - æŸ¥çœ‹ **Real-time Logs**

3. **éªŒè¯ R2 å­˜å‚¨æ¡¶å†…å®¹**
   - åœ¨ R2 Dashboard ä¸­æ£€æŸ¥æ–‡ä»¶ç»“æ„
   - ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªæ­£ç¡®æ ¼å¼çš„æ­Œæ›²æ–‡ä»¶å¤¹

### å¸¸è§é”™è¯¯æ¶ˆæ¯

- `"SONG_BUCKET binding is missing"` â†’ éœ€è¦é…ç½® R2 ç»‘å®š
- `"Could not list songs from R2 bucket"` â†’ æ£€æŸ¥å­˜å‚¨æ¡¶æƒé™å’Œåç§°
- `"ç½‘ç»œè¿æ¥é”™è¯¯"` â†’ æ£€æŸ¥ API ç«¯ç‚¹å’Œ CORS é…ç½®

## æœ¬åœ°å¼€å‘

å¦‚æœéœ€è¦åœ¨æœ¬åœ°å¼€å‘å’Œæµ‹è¯•ï¼š

1. å®‰è£… Wrangler CLIï¼š
   ```bash
   npm install -g wrangler
   ```

2. ç™»å½• Cloudflareï¼š
   ```bash
   wrangler login
   ```

3. æœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼š
   ```bash
   wrangler pages dev .
   ```

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: HTML5, CSS3, JavaScript (ES6+)
- **éŸ³é¢‘å¤„ç†**: HTML5 Audio API
- **ä¸‹è½½åŠŸèƒ½**: JSZip
- **åç«¯**: Cloudflare Pages Functions
- **å­˜å‚¨**: Cloudflare R2
- **æ’åº**: pinyin-pro (ä¸­æ–‡æ‹¼éŸ³æ’åº)

## é…ç½®æ–‡ä»¶è¯´æ˜

- `functions/api/songs.js`: Cloudflare Pages Functionï¼Œè‡ªåŠ¨æ‰«æ R2 å­˜å‚¨æ¡¶
- `wrangler.toml`: Cloudflare Worker é…ç½®ï¼ˆä»…ç”¨äºç‹¬ç«‹ Worker éƒ¨ç½²ï¼‰
- `scripts.js`: å‰ç«¯ä¸»è¦é€»è¾‘
- `styles.css`: æ ·å¼æ–‡ä»¶
- `index.html`: ä¸»é¡µé¢

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---
*æœ€åæ›´æ–°: 2024-01-XX*
<!-- è§¦å‘éƒ¨ç½²: ä¿®å¤Cloudflare Pageså†…éƒ¨é”™è¯¯ -->
